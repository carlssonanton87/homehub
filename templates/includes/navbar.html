<nav class="border-b bg-white">
  <div class="mx-auto max-w-5xl px-4 py-3">
    <div class="flex items-center justify-between">
      <a href="{% url 'core:home' %}" class="font-semibold tracking-tight text-slate-900">
        Homehub
      </a>

      <!-- Desktop nav -->
      <div class="hidden md:flex items-center gap-2">
        {% with p=request.path %}
          <a href="{% url 'documents:list' %}"
             class="rounded-lg px-3 py-2 text-sm
                    {% if '/documents/' in p %}bg-slate-100 text-slate-900{% else %}text-slate-600 hover:bg-slate-100 hover:text-slate-900{% endif %}">
            Documents
          </a>

          <a href="{% url 'contacts:list' %}"
             class="rounded-lg px-3 py-2 text-sm
                    {% if '/contacts/' in p %}bg-slate-100 text-slate-900{% else %}text-slate-600 hover:bg-slate-100 hover:text-slate-900{% endif %}">
            Contacts
          </a>

          <a href="{% url 'expenses:list' %}"
             class="rounded-lg px-3 py-2 text-sm
                    {% if '/expenses/' in p %}bg-slate-100 text-slate-900{% else %}text-slate-600 hover:bg-slate-100 hover:text-slate-900{% endif %}">
            Expenses
          </a>

          <a href="{% url 'payments:upgrade' %}"
             class="rounded-lg px-3 py-2 text-sm flex items-center gap-2
                    {% if '/payments/' in p %}bg-slate-100 text-slate-900{% else %}text-slate-600 hover:bg-slate-100 hover:text-slate-900{% endif %}">
            Upgrade
            {% if user.is_authenticated and not is_premium %}
              <span class="rounded-full bg-slate-900 px-2 py-0.5 text-[11px] font-medium text-white">
                Free
              </span>
            {% endif %}
          </a>
        {% endwith %}

        <div class="ml-2 h-6 w-px bg-slate-200"></div>

        {% if user.is_authenticated %}
          <span class="text-sm text-slate-500">
            Plan:
            {% if is_premium %}
              <span class="ml-1 rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-200">
                Premium
              </span>
            {% else %}
              <span class="ml-1 rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-medium text-slate-700 ring-1 ring-slate-200">
                Free
              </span>
            {% endif %}
          </span>

          <span class="text-sm text-slate-500 hidden lg:inline">Hi, {{ user.username }}</span>

          <form action="{% url 'accounts:logout' %}" method="post" class="inline">
            {% csrf_token %}
            <button type="submit"
                    class="rounded-lg px-3 py-2 text-sm text-slate-600 hover:bg-slate-100 hover:text-slate-900">
              Logout
            </button>
          </form>
        {% else %}
          <a href="{% url 'accounts:login' %}"
             class="rounded-lg px-3 py-2 text-sm text-slate-600 hover:bg-slate-100 hover:text-slate-900">
            Login
          </a>
          <a href="{% url 'accounts:signup' %}"
             class="rounded-lg bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-800">
            Sign up
          </a>
        {% endif %}
      </div>

      <!-- Mobile toggle -->
      <button
        type="button"
        class="md:hidden rounded-lg p-2 text-slate-600 hover:bg-slate-100 hover:text-slate-900"
        aria-label="Open menu"
        aria-controls="mobile-menu"
        aria-expanded="false"
        onclick="const m=document.getElementById('mobile-menu'); const e=this.getAttribute('aria-expanded')==='true'; this.setAttribute('aria-expanded', String(!e)); m.classList.toggle('hidden');"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden md:hidden pt-3">
      <div class="flex flex-col gap-2">
        <a href="{% url 'documents:list' %}" class="rounded-lg px-3 py-2 text-sm text-slate-700 hover:bg-slate-100">Documents</a>
        <a href="{% url 'contacts:list' %}" class="rounded-lg px-3 py-2 text-sm text-slate-700 hover:bg-slate-100">Contacts</a>
        <a href="{% url 'expenses:list' %}" class="rounded-lg px-3 py-2 text-sm text-slate-700 hover:bg-slate-100">Expenses</a>

        <a href="{% url 'payments:upgrade' %}" class="rounded-lg px-3 py-2 text-sm text-slate-700 hover:bg-slate-100 flex items-center justify-between">
          <span>Upgrade</span>
          {% if user.is_authenticated %}
            {% if is_premium %}
              <span class="rounded-full bg-emerald-50 px-2 py-0.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-200">Premium</span>
            {% else %}
              <span class="rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-medium text-slate-700 ring-1 ring-slate-200">Free</span>
            {% endif %}
          {% endif %}
        </a>

        <div class="h-px bg-slate-200 my-2"></div>

        {% if user.is_authenticated %}
          <div class="px-3 text-sm text-slate-500">Signed in as {{ user.username }}</div>
          <form action="{% url 'accounts:logout' %}" method="post" class="px-3">
            {% csrf_token %}
            <button type="submit"
                    class="w-full rounded-lg px-3 py-2 text-left text-sm text-slate-700 hover:bg-slate-100">
              Logout
            </button>
          </form>
        {% else %}
          <a href="{% url 'accounts:login' %}" class="rounded-lg px-3 py-2 text-sm text-slate-700 hover:bg-slate-100">Login</a>
          <a href="{% url 'accounts:signup' %}" class="rounded-lg bg-slate-900 px-3 py-2 text-sm font-medium text-white hover:bg-slate-800">Sign up</a>
        {% endif %}
      </div>
    </div>
  </div>
</nav>
